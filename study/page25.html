<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.48">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <title>SQL | Chenxuwkk's Blog</title><meta name="description" content="Chenxuwkk's Blog">
    <link rel="modulepreload" href="/blog/assets/app.b33ca31f.js"><link rel="modulepreload" href="/blog/assets/page25.html.b0d918c5.js"><link rel="modulepreload" href="/blog/assets/page25.html.47a43782.js"><link rel="prefetch" href="/blog/assets/about.html.1a741a35.js"><link rel="prefetch" href="/blog/assets/contact.html.03aacf5e.js"><link rel="prefetch" href="/blog/assets/index.html.2e04d9b1.js"><link rel="prefetch" href="/blog/assets/index.html.dc88bf6f.js"><link rel="prefetch" href="/blog/assets/page01.html.6f1784f0.js"><link rel="prefetch" href="/blog/assets/index.html.b2e428a6.js"><link rel="prefetch" href="/blog/assets/page01.html.8647912c.js"><link rel="prefetch" href="/blog/assets/page02.html.2ae31539.js"><link rel="prefetch" href="/blog/assets/page03.html.e30663aa.js"><link rel="prefetch" href="/blog/assets/page04.html.5b5a177e.js"><link rel="prefetch" href="/blog/assets/page05.html.8dc876d3.js"><link rel="prefetch" href="/blog/assets/index.html.1faed378.js"><link rel="prefetch" href="/blog/assets/page00.html.397ec4cb.js"><link rel="prefetch" href="/blog/assets/page01.html.d4c49eb5.js"><link rel="prefetch" href="/blog/assets/page02.html.512e9f97.js"><link rel="prefetch" href="/blog/assets/page03.html.07c7a8d5.js"><link rel="prefetch" href="/blog/assets/page04.html.ea9d586c.js"><link rel="prefetch" href="/blog/assets/page05.html.c54831cd.js"><link rel="prefetch" href="/blog/assets/page06.html.130549e7.js"><link rel="prefetch" href="/blog/assets/page07.html.7c7f84ea.js"><link rel="prefetch" href="/blog/assets/page08.html.e3c59864.js"><link rel="prefetch" href="/blog/assets/page09.html.4785a4a4.js"><link rel="prefetch" href="/blog/assets/page10.html.c6168586.js"><link rel="prefetch" href="/blog/assets/page11.html.ce54a18d.js"><link rel="prefetch" href="/blog/assets/page12.html.1814d2d6.js"><link rel="prefetch" href="/blog/assets/page13.html.3976787d.js"><link rel="prefetch" href="/blog/assets/page14.html.810a54e6.js"><link rel="prefetch" href="/blog/assets/page15.html.3ad37cea.js"><link rel="prefetch" href="/blog/assets/page16.html.c8b15e87.js"><link rel="prefetch" href="/blog/assets/page17.html.bda23cdd.js"><link rel="prefetch" href="/blog/assets/page18.html.8e431832.js"><link rel="prefetch" href="/blog/assets/page19.html.4f7e6a54.js"><link rel="prefetch" href="/blog/assets/page20.html.53b884d3.js"><link rel="prefetch" href="/blog/assets/page21.html.ea7e75ec.js"><link rel="prefetch" href="/blog/assets/page22.html.6a8a8911.js"><link rel="prefetch" href="/blog/assets/page23.html.4da8711b.js"><link rel="prefetch" href="/blog/assets/page24.html.f15f76b8.js"><link rel="prefetch" href="/blog/assets/index.html.09d3b996.js"><link rel="prefetch" href="/blog/assets/404.html.265028f6.js"><link rel="prefetch" href="/blog/assets/about.html.7c2de1fc.js"><link rel="prefetch" href="/blog/assets/contact.html.af265cd3.js"><link rel="prefetch" href="/blog/assets/index.html.494633a3.js"><link rel="prefetch" href="/blog/assets/index.html.6f6ef67c.js"><link rel="prefetch" href="/blog/assets/page01.html.24477c8b.js"><link rel="prefetch" href="/blog/assets/index.html.06f044c7.js"><link rel="prefetch" href="/blog/assets/page01.html.2c2c82ac.js"><link rel="prefetch" href="/blog/assets/page02.html.519c6760.js"><link rel="prefetch" href="/blog/assets/page03.html.9c782bee.js"><link rel="prefetch" href="/blog/assets/page04.html.01792834.js"><link rel="prefetch" href="/blog/assets/page05.html.ecd56c0e.js"><link rel="prefetch" href="/blog/assets/index.html.0d805a32.js"><link rel="prefetch" href="/blog/assets/page00.html.b5b8a137.js"><link rel="prefetch" href="/blog/assets/page01.html.196f31d8.js"><link rel="prefetch" href="/blog/assets/page02.html.446eff9c.js"><link rel="prefetch" href="/blog/assets/page03.html.265319dc.js"><link rel="prefetch" href="/blog/assets/page04.html.839ac225.js"><link rel="prefetch" href="/blog/assets/page05.html.3ba90d93.js"><link rel="prefetch" href="/blog/assets/page06.html.5ec3bc24.js"><link rel="prefetch" href="/blog/assets/page07.html.9811e105.js"><link rel="prefetch" href="/blog/assets/page08.html.550b989b.js"><link rel="prefetch" href="/blog/assets/page09.html.e59328fe.js"><link rel="prefetch" href="/blog/assets/page10.html.42d79a00.js"><link rel="prefetch" href="/blog/assets/page11.html.07064880.js"><link rel="prefetch" href="/blog/assets/page12.html.29d2532a.js"><link rel="prefetch" href="/blog/assets/page13.html.31c29b64.js"><link rel="prefetch" href="/blog/assets/page14.html.ad9dcffb.js"><link rel="prefetch" href="/blog/assets/page15.html.58f3b33b.js"><link rel="prefetch" href="/blog/assets/page16.html.8841620e.js"><link rel="prefetch" href="/blog/assets/page17.html.bc75eefa.js"><link rel="prefetch" href="/blog/assets/page18.html.467eb0c9.js"><link rel="prefetch" href="/blog/assets/page19.html.55cbf803.js"><link rel="prefetch" href="/blog/assets/page20.html.8b45092f.js"><link rel="prefetch" href="/blog/assets/page21.html.cc2b2ea3.js"><link rel="prefetch" href="/blog/assets/page22.html.d7349c76.js"><link rel="prefetch" href="/blog/assets/page23.html.e468a4f1.js"><link rel="prefetch" href="/blog/assets/page24.html.af7dd849.js"><link rel="prefetch" href="/blog/assets/index.html.1b0cec2a.js"><link rel="prefetch" href="/blog/assets/404.html.b1b48cf0.js"><link rel="prefetch" href="/blog/assets/404.515c5f58.js"><link rel="prefetch" href="/blog/assets/Layout.14a38178.js"><link rel="prefetch" href="/blog/assets/auto.esm.36809f22.js"><link rel="prefetch" href="/blog/assets/index.daae04bf.js"><link rel="prefetch" href="/blog/assets/index.1842ee54.js"><link rel="prefetch" href="/blog/assets/mermaid.esm.min.ee1e0284.js">
    <link rel="stylesheet" href="/blog/assets/style.f6d73350.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/blog/" class=""><img class="logo" src="/blog/assets/img/logo.png" alt="Chenxuwkk&#39;s Blog"><span class="site-name can-hide">Chenxuwkk&#39;s Blog</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/blog/" class="" aria-label="首页"><!--[--><!--]--> 首页 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="导航"><span class="title">导航</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="导航"><span class="title">导航</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/blog/guide/" class="" aria-label="指南"><!--[--><!--]--> 指南 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/blog/study/page01" class="" aria-label="学习记录"><!--[--><!--]--> 学习记录 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/blog/question/page01" class="" aria-label="疑难问题"><!--[--><!--]--> 疑难问题 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/blog/manuscript/page01" class="" aria-label="草稿本"><!--[--><!--]--> 草稿本 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/blog/contact" class="" aria-label="联系本人"><!--[--><!--]--> 联系本人 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/blog/about/" class="" aria-label="关于"><!--[--><!--]--> 关于 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/Chenxuwkk" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><div id="docsearch-container"></div></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/blog/" class="" aria-label="首页"><!--[--><!--]--> 首页 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="导航"><span class="title">导航</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="导航"><span class="title">导航</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/blog/guide/" class="" aria-label="指南"><!--[--><!--]--> 指南 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/blog/study/page01" class="" aria-label="学习记录"><!--[--><!--]--> 学习记录 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/blog/question/page01" class="" aria-label="疑难问题"><!--[--><!--]--> 疑难问题 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/blog/manuscript/page01" class="" aria-label="草稿本"><!--[--><!--]--> 草稿本 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/blog/contact" class="" aria-label="联系本人"><!--[--><!--]--> 联系本人 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/blog/about/" class="" aria-label="关于"><!--[--><!--]--> 关于 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/Chenxuwkk" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><a href="/blog/guide/" class="sidebar-item sidebar-heading" aria-label="指南"><!--[--><!--]--> 指南 <!--[--><!--]--></a><!----></li><li><p tabindex="0" class="sidebar-item sidebar-heading active">学习记录 <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/blog/study/page01.html" class="sidebar-item" aria-label="Vuepress部署"><!--[--><!--]--> Vuepress部署 <!--[--><!--]--></a><!----></li><li><a href="/blog/study/page03.html" class="sidebar-item" aria-label="Linux 命令"><!--[--><!--]--> Linux 命令 <!--[--><!--]--></a><!----></li><li><a href="/blog/study/page02.html" class="sidebar-item" aria-label="C语言预处理"><!--[--><!--]--> C语言预处理 <!--[--><!--]--></a><!----></li><li><a href="/blog/study/page04.html" class="sidebar-item" aria-label="C语言位运算"><!--[--><!--]--> C语言位运算 <!--[--><!--]--></a><!----></li><li><a href="/blog/study/page05.html" class="sidebar-item" aria-label="C语言指针"><!--[--><!--]--> C语言指针 <!--[--><!--]--></a><!----></li><li><a href="/blog/study/page07.html" class="sidebar-item" aria-label="C语言动态内存"><!--[--><!--]--> C语言动态内存 <!--[--><!--]--></a><!----></li><li><a href="/blog/study/page08.html" class="sidebar-item" aria-label="C语言字符串处理"><!--[--><!--]--> C语言字符串处理 <!--[--><!--]--></a><!----></li><li><a href="/blog/study/page09.html" class="sidebar-item" aria-label="C语言结构体详解"><!--[--><!--]--> C语言结构体详解 <!--[--><!--]--></a><!----></li><li><a href="/blog/study/page10.html" class="sidebar-item" aria-label="C语言链表"><!--[--><!--]--> C语言链表 <!--[--><!--]--></a><!----></li><li><a href="/blog/study/page21.html" class="sidebar-item" aria-label="C++对C语言的加强"><!--[--><!--]--> C++对C语言的加强 <!--[--><!--]--></a><!----></li><li><a href="/blog/study/page06.html" class="sidebar-item" aria-label="Markdown高级技巧"><!--[--><!--]--> Markdown高级技巧 <!--[--><!--]--></a><!----></li><li><a href="/blog/study/page11.html" class="sidebar-item" aria-label="Makefile"><!--[--><!--]--> Makefile <!--[--><!--]--></a><!----></li><li><a href="/blog/study/page12.html" class="sidebar-item" aria-label="C51"><!--[--><!--]--> C51 <!--[--><!--]--></a><!----></li><li><a href="/blog/study/page13.html" class="sidebar-item" aria-label="STM32"><!--[--><!--]--> STM32 <!--[--><!--]--></a><!----></li><li><a href="/blog/study/page14.html" class="sidebar-item" aria-label="嵌入式小记"><!--[--><!--]--> 嵌入式小记 <!--[--><!--]--></a><!----></li><li><a href="/blog/study/page15.html" class="sidebar-item" aria-label="IMRD"><!--[--><!--]--> IMRD <!--[--><!--]--></a><!----></li><li><a href="/blog/study/page17.html" class="sidebar-item" aria-label="Paxos算法"><!--[--><!--]--> Paxos算法 <!--[--><!--]--></a><!----></li><li><a href="/blog/study/page18.html" class="sidebar-item" aria-label="STL"><!--[--><!--]--> STL <!--[--><!--]--></a><!----></li><li><a href="/blog/study/page19.html" class="sidebar-item" aria-label="Python"><!--[--><!--]--> Python <!--[--><!--]--></a><!----></li><li><a href="/blog/study/page16.html" class="sidebar-item" aria-label="Leetcode"><!--[--><!--]--> Leetcode <!--[--><!--]--></a><!----></li><li><a href="/blog/study/page20.html" class="sidebar-item" aria-label="剑指Offer"><!--[--><!--]--> 剑指Offer <!--[--><!--]--></a><!----></li><li><a href="/blog/study/page22.html" class="sidebar-item" aria-label="剑指Offer II"><!--[--><!--]--> 剑指Offer II <!--[--><!--]--></a><!----></li><li><a href="/blog/study/page23.html" class="sidebar-item" aria-label="二分专项"><!--[--><!--]--> 二分专项 <!--[--><!--]--></a><!----></li><li><a href="/blog/study/page24.html" class="sidebar-item" aria-label="动态规划专项"><!--[--><!--]--> 动态规划专项 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog/study/page25.html" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="SQL"><!--[--><!--]--> SQL <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/blog/study/page25.html#大的国家-595" class="router-link-active router-link-exact-active sidebar-item" aria-label="大的国家（595）"><!--[--><!--]--> 大的国家（595） <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog/study/page25.html#可回收且低脂的产品-1757" class="router-link-active router-link-exact-active sidebar-item" aria-label="可回收且低脂的产品（1757）"><!--[--><!--]--> 可回收且低脂的产品（1757） <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog/study/page25.html#寻找用户推荐人-584" class="router-link-active router-link-exact-active sidebar-item" aria-label="寻找用户推荐人（584）"><!--[--><!--]--> 寻找用户推荐人（584） <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog/study/page25.html#从不订购的客户-183" class="router-link-active router-link-exact-active sidebar-item" aria-label="从不订购的客户（183）"><!--[--><!--]--> 从不订购的客户（183） <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog/study/page25.html#计算特殊奖金-1873" class="router-link-active router-link-exact-active sidebar-item" aria-label="计算特殊奖金（1873）"><!--[--><!--]--> 计算特殊奖金（1873） <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog/study/page25.html#变更性别-627" class="router-link-active router-link-exact-active sidebar-item" aria-label="变更性别（627）"><!--[--><!--]--> 变更性别（627） <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog/study/page25.html#删除重复的电子邮箱-196" class="router-link-active router-link-exact-active sidebar-item" aria-label="删除重复的电子邮箱（196）"><!--[--><!--]--> 删除重复的电子邮箱（196） <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog/study/page25.html#修复表中的名字-1667" class="router-link-active router-link-exact-active sidebar-item" aria-label="修复表中的名字（1667）"><!--[--><!--]--> 修复表中的名字（1667） <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog/study/page25.html#按日期分组销售产品-1484" class="router-link-active router-link-exact-active sidebar-item" aria-label="按日期分组销售产品（1484）"><!--[--><!--]--> 按日期分组销售产品（1484） <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog/study/page25.html#患某种疾病的患者-1527" class="router-link-active router-link-exact-active sidebar-item" aria-label="患某种疾病的患者（1527）"><!--[--><!--]--> 患某种疾病的患者（1527） <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog/study/page25.html#丢失信息的雇员-1965" class="router-link-active router-link-exact-active sidebar-item" aria-label="丢失信息的雇员（1965）"><!--[--><!--]--> 丢失信息的雇员（1965） <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog/study/page25.html#每个产品在不同商店的价格-1795" class="router-link-active router-link-exact-active sidebar-item" aria-label="每个产品在不同商店的价格（1795）"><!--[--><!--]--> 每个产品在不同商店的价格（1795） <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog/study/page25.html#树节点-608" class="router-link-active router-link-exact-active sidebar-item" aria-label="树节点（608）"><!--[--><!--]--> 树节点（608） <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog/study/page25.html#第二高的薪水-176" class="router-link-active router-link-exact-active sidebar-item" aria-label="第二高的薪水（176）"><!--[--><!--]--> 第二高的薪水（176） <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog/study/page25.html#组合两个表-175" class="router-link-active router-link-exact-active sidebar-item" aria-label="组合两个表（175）"><!--[--><!--]--> 组合两个表（175） <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog/study/page25.html#进店却未进行过交易的顾客-1581" class="router-link-active router-link-exact-active sidebar-item" aria-label="进店却未进行过交易的顾客（1581）"><!--[--><!--]--> 进店却未进行过交易的顾客（1581） <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog/study/page25.html#文章浏览-i-1148" class="router-link-active router-link-exact-active sidebar-item" aria-label="文章浏览 I（1148）"><!--[--><!--]--> 文章浏览 I（1148） <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog/study/page25.html#上升的温度-197" class="router-link-active router-link-exact-active sidebar-item" aria-label="上升的温度（197）"><!--[--><!--]--> 上升的温度（197） <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog/study/page25.html#销售员-607" class="router-link-active router-link-exact-active sidebar-item" aria-label="销售员（607）"><!--[--><!--]--> 销售员（607） <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog/study/page25.html#查询近30天活跃用户数-1141" class="router-link-active router-link-exact-active sidebar-item" aria-label="查询近30天活跃用户数（1141）"><!--[--><!--]--> 查询近30天活跃用户数（1141） <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog/study/page25.html#每天的领导和合伙人-1693" class="router-link-active router-link-exact-active sidebar-item" aria-label="每天的领导和合伙人（1693）"><!--[--><!--]--> 每天的领导和合伙人（1693） <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog/study/page25.html#求关注者的数量-1729" class="router-link-active router-link-exact-active sidebar-item" aria-label="求关注者的数量（1729）"><!--[--><!--]--> 求关注者的数量（1729） <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog/study/page25.html#订单最多的客户-586" class="router-link-active router-link-exact-active sidebar-item" aria-label="订单最多的客户（586）"><!--[--><!--]--> 订单最多的客户（586） <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog/study/page25.html#游戏玩法分析-i-511" class="router-link-active router-link-exact-active sidebar-item" aria-label="游戏玩法分析 I（511）"><!--[--><!--]--> 游戏玩法分析 I（511） <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog/study/page25.html#_2020年最后一次登录-1890" class="router-link-active router-link-exact-active sidebar-item" aria-label="2020年最后一次登录（1890）"><!--[--><!--]--> 2020年最后一次登录（1890） <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog/study/page25.html#查找每个员工花费的总时间-1741" class="router-link-active router-link-exact-active sidebar-item" aria-label="查找每个员工花费的总时间（1741）"><!--[--><!--]--> 查找每个员工花费的总时间（1741） <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">疑难问题 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/blog/question/page01.html" class="sidebar-item" aria-label="Git同步 😄"><!--[--><!--]--> Git同步 😄 <!--[--><!--]--></a><!----></li><li><a href="/blog/question/page02.html" class="sidebar-item" aria-label="Ubantu内存重新分配（Vmware） 🍎"><!--[--><!--]--> Ubantu内存重新分配（Vmware） 🍎 <!--[--><!--]--></a><!----></li><li><a href="/blog/question/page03.html" class="sidebar-item" aria-label="一个个小坑（Vue） 💢"><!--[--><!--]--> 一个个小坑（Vue） 💢 <!--[--><!--]--></a><!----></li><li><a href="/blog/question/page04.html" class="sidebar-item" aria-label="VSCode编译C\C++"><!--[--><!--]--> VSCode编译C\C++ <!--[--><!--]--></a><!----></li><li><a href="/blog/question/page05.html" class="sidebar-item" aria-label="代码复现问题"><!--[--><!--]--> 代码复现问题 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a href="/blog/manuscript/page01" class="sidebar-item sidebar-heading" aria-label="草稿本"><!--[--><!--]--> 草稿本 <!--[--><!--]--></a><!----></li><li><a href="/blog/contact" class="sidebar-item sidebar-heading collapsible" aria-label="联系本人"><!--[--><!--]--> 联系本人 <!--[--><!--]--></a><!----></li><li><a href="/blog/about" class="sidebar-item sidebar-heading" aria-label="关于"><!--[--><!--]--> 关于 <!--[--><!--]--></a><!----></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="sql" tabindex="-1"><a class="header-anchor" href="#sql" aria-hidden="true">#</a> SQL</h1><hr><nav class="table-of-contents"><ul><li><a aria-current="page" href="/blog/study/page25.html#大的国家-595" class="router-link-active router-link-exact-active">大的国家（595）</a></li><li><a aria-current="page" href="/blog/study/page25.html#可回收且低脂的产品-1757" class="router-link-active router-link-exact-active">可回收且低脂的产品（1757）</a></li><li><a aria-current="page" href="/blog/study/page25.html#寻找用户推荐人-584" class="router-link-active router-link-exact-active">寻找用户推荐人（584）</a></li><li><a aria-current="page" href="/blog/study/page25.html#从不订购的客户-183" class="router-link-active router-link-exact-active">从不订购的客户（183）</a></li><li><a aria-current="page" href="/blog/study/page25.html#计算特殊奖金-1873" class="router-link-active router-link-exact-active">计算特殊奖金（1873）</a></li><li><a aria-current="page" href="/blog/study/page25.html#变更性别-627" class="router-link-active router-link-exact-active">变更性别（627）</a></li><li><a aria-current="page" href="/blog/study/page25.html#删除重复的电子邮箱-196" class="router-link-active router-link-exact-active">删除重复的电子邮箱（196）</a></li><li><a aria-current="page" href="/blog/study/page25.html#修复表中的名字-1667" class="router-link-active router-link-exact-active">修复表中的名字（1667）</a></li><li><a aria-current="page" href="/blog/study/page25.html#按日期分组销售产品-1484" class="router-link-active router-link-exact-active">按日期分组销售产品（1484）</a></li><li><a aria-current="page" href="/blog/study/page25.html#患某种疾病的患者-1527" class="router-link-active router-link-exact-active">患某种疾病的患者（1527）</a></li><li><a aria-current="page" href="/blog/study/page25.html#丢失信息的雇员-1965" class="router-link-active router-link-exact-active">丢失信息的雇员（1965）</a></li><li><a aria-current="page" href="/blog/study/page25.html#每个产品在不同商店的价格-1795" class="router-link-active router-link-exact-active">每个产品在不同商店的价格（1795）</a></li><li><a aria-current="page" href="/blog/study/page25.html#树节点-608" class="router-link-active router-link-exact-active">树节点（608）</a></li><li><a aria-current="page" href="/blog/study/page25.html#第二高的薪水-176" class="router-link-active router-link-exact-active">第二高的薪水（176）</a></li><li><a aria-current="page" href="/blog/study/page25.html#组合两个表-175" class="router-link-active router-link-exact-active">组合两个表（175）</a></li><li><a aria-current="page" href="/blog/study/page25.html#进店却未进行过交易的顾客-1581" class="router-link-active router-link-exact-active">进店却未进行过交易的顾客（1581）</a></li><li><a aria-current="page" href="/blog/study/page25.html#文章浏览-i-1148" class="router-link-active router-link-exact-active">文章浏览 I（1148）</a></li><li><a aria-current="page" href="/blog/study/page25.html#上升的温度-197" class="router-link-active router-link-exact-active">上升的温度（197）</a></li><li><a aria-current="page" href="/blog/study/page25.html#销售员-607" class="router-link-active router-link-exact-active">销售员（607）</a></li><li><a aria-current="page" href="/blog/study/page25.html#查询近30天活跃用户数-1141" class="router-link-active router-link-exact-active">查询近30天活跃用户数（1141）</a></li><li><a aria-current="page" href="/blog/study/page25.html#每天的领导和合伙人-1693" class="router-link-active router-link-exact-active">每天的领导和合伙人（1693）</a></li><li><a aria-current="page" href="/blog/study/page25.html#求关注者的数量-1729" class="router-link-active router-link-exact-active">求关注者的数量（1729）</a></li><li><a aria-current="page" href="/blog/study/page25.html#订单最多的客户-586" class="router-link-active router-link-exact-active">订单最多的客户（586）</a></li><li><a aria-current="page" href="/blog/study/page25.html#游戏玩法分析-i-511" class="router-link-active router-link-exact-active">游戏玩法分析 I（511）</a></li><li><a aria-current="page" href="/blog/study/page25.html#_2020年最后一次登录-1890" class="router-link-active router-link-exact-active">2020年最后一次登录（1890）</a></li><li><a aria-current="page" href="/blog/study/page25.html#查找每个员工花费的总时间-1741" class="router-link-active router-link-exact-active">查找每个员工花费的总时间（1741）</a></li></ul></nav><h2 id="大的国家-595" tabindex="-1"><a class="header-anchor" href="#大的国家-595" aria-hidden="true">#</a> 大的国家（595）</h2><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
    name<span class="token punctuation">,</span>population<span class="token punctuation">,</span>area 
<span class="token keyword">FROM</span>
    World
<span class="token keyword">WHERE</span>
    area<span class="token operator">&gt;=</span><span class="token number">3000000</span> <span class="token operator">OR</span> population<span class="token operator">&gt;=</span><span class="token number">25000000</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- 使用 UNION 连接子查询，方法二 比 方法一 运行速度更快，但是它们没有太大差别</span>
<span class="token keyword">SELECT</span> name<span class="token punctuation">,</span>
        population<span class="token punctuation">,</span>
        area
<span class="token keyword">FROM</span> World
<span class="token keyword">WHERE</span> area<span class="token operator">&gt;=</span><span class="token number">3000000</span>
<span class="token keyword">UNION</span>
<span class="token keyword">SELECT</span> name<span class="token punctuation">,</span>
        population<span class="token punctuation">,</span>
        area
<span class="token keyword">FROM</span> World
<span class="token keyword">WHERE</span> population<span class="token operator">&gt;=</span><span class="token number">25000000</span><span class="token punctuation">;</span>
<span class="token comment">-- 使用 or 会使索引会失效，在数据量较大的时候查找效率较低，通常建议使用 union 代替 or。</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="可回收且低脂的产品-1757" tabindex="-1"><a class="header-anchor" href="#可回收且低脂的产品-1757" aria-hidden="true">#</a> 可回收且低脂的产品（1757）</h2><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> product_id
<span class="token keyword">FROM</span> Products
<span class="token keyword">WHERE</span> low_fats<span class="token operator">=</span><span class="token string">&#39;Y&#39;</span>
        <span class="token operator">AND</span> recyclable<span class="token operator">=</span><span class="token string">&#39;Y&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="寻找用户推荐人-584" tabindex="-1"><a class="header-anchor" href="#寻找用户推荐人-584" aria-hidden="true">#</a> 寻找用户推荐人（584）</h2><ol><li>不能先查出name，否则可能name有重名，id不同，导致数据查询不全。</li></ol><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> name
<span class="token keyword">FROM</span> customer C <span class="token comment">-- 别名</span>
<span class="token keyword">WHERE</span> C<span class="token punctuation">.</span>id <span class="token operator">NOT</span> <span class="token operator">IN</span> 
    <span class="token punctuation">(</span><span class="token keyword">SELECT</span> C1<span class="token punctuation">.</span>id
    <span class="token keyword">FROM</span> customer C1
    <span class="token keyword">WHERE</span> C1<span class="token punctuation">.</span>referee_id <span class="token operator">=</span> <span class="token number">2</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>使用exists，先查出referee_id的数据，再用exists,注意语法，exists需要关联表。</li></ol><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> C<span class="token punctuation">.</span>name
<span class="token keyword">FROM</span> customer C
<span class="token keyword">WHERE</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> 
    <span class="token punctuation">(</span><span class="token keyword">SELECT</span> C1<span class="token punctuation">.</span>name
    <span class="token keyword">FROM</span> customer C1
    <span class="token keyword">WHERE</span> C1<span class="token punctuation">.</span>id <span class="token operator">=</span> C<span class="token punctuation">.</span>id
            <span class="token operator">AND</span> C1<span class="token punctuation">.</span> referee_id <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>直接增加第二个判断，用OR。</li></ol><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> C<span class="token punctuation">.</span>name
<span class="token keyword">FROM</span> customer C
<span class="token keyword">WHERE</span> C<span class="token punctuation">.</span> referee_id <span class="token operator">&lt;&gt;</span> <span class="token number">2</span>
        <span class="token operator">OR</span> C<span class="token punctuation">.</span> referee_id <span class="token operator">IS</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="4"><li>用UNION ALL</li></ol><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> name
<span class="token keyword">FROM</span> customer
<span class="token keyword">WHERE</span> referee_id <span class="token operator">&lt;&gt;</span> <span class="token number">2</span>
<span class="token keyword">UNION</span>
ALLSELECT name
<span class="token keyword">FROM</span> customer
<span class="token keyword">WHERE</span> referee_id <span class="token operator">IS</span> <span class="token boolean">NULL</span><span class="token punctuation">.</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="从不订购的客户-183" tabindex="-1"><a class="header-anchor" href="#从不订购的客户-183" aria-hidden="true">#</a> 从不订购的客户（183）</h2><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> C<span class="token punctuation">.</span>Name <span class="token keyword">AS</span> <span class="token string">&quot;Customers&quot;</span>
<span class="token keyword">FROM</span> Customers C
<span class="token keyword">WHERE</span> C<span class="token punctuation">.</span>id <span class="token operator">NOT</span> <span class="token operator">IN</span> 
    <span class="token punctuation">(</span><span class="token keyword">SELECT</span> CustomerId
    <span class="token keyword">FROM</span> Orders <span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="计算特殊奖金-1873" tabindex="-1"><a class="header-anchor" href="#计算特殊奖金-1873" aria-hidden="true">#</a> 计算特殊奖金（1873）</h2><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span> employee_id<span class="token operator">%</span><span class="token number">2</span><span class="token operator">=</span><span class="token number">1</span>
        <span class="token operator">AND</span> name <span class="token operator">NOT</span> <span class="token operator">LIKE</span> <span class="token string">&#39;M%&#39;</span><span class="token punctuation">,</span> salary<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">)</span> <span class="token keyword">AS</span> bonus
<span class="token keyword">FROM</span> employees
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span>  employee_id<span class="token punctuation">;</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>
    <span class="token keyword">CASE</span>
    <span class="token keyword">WHEN</span> <span class="token function">MOD</span><span class="token punctuation">(</span>employee_id<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">0</span>
        <span class="token operator">AND</span> <span class="token keyword">LEFT</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token string">&#39;M&#39;</span> <span class="token keyword">THEN</span>
    salary
    <span class="token keyword">WHEN</span> <span class="token function">MOD</span><span class="token punctuation">(</span>employee_id<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">0</span>
        <span class="token operator">OR</span> <span class="token keyword">LEFT</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">&#39;M&#39;</span> <span class="token keyword">THEN</span>
    <span class="token number">0</span>
    <span class="token keyword">ELSE</span> <span class="token number">0</span> <span class="token comment">-- 这里ELSE可以省略</span>
    <span class="token keyword">END</span> <span class="token keyword">AS</span> bonus
<span class="token keyword">FROM</span> Employees
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span>  employee_id
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="变更性别-627" tabindex="-1"><a class="header-anchor" href="#变更性别-627" aria-hidden="true">#</a> 变更性别（627）</h2><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">UPDATE</span> Salary <span class="token keyword">SET</span> sex <span class="token operator">=</span>
    <span class="token keyword">CASE</span>
    <span class="token keyword">WHEN</span> sex<span class="token operator">=</span><span class="token string">&#39;m&#39;</span> <span class="token keyword">THEN</span>
    <span class="token string">&#39;f&#39;</span>
    <span class="token keyword">WHEN</span> sex<span class="token operator">=</span><span class="token string">&#39;f&#39;</span> <span class="token keyword">THEN</span>
    <span class="token string">&#39;m&#39;</span> <span class="token keyword">end</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">UPDATE</span> salary <span class="token keyword">SET</span> sex <span class="token operator">=</span>
    <span class="token keyword">CASE</span> sex
    <span class="token keyword">WHEN</span> <span class="token string">&#39;m&#39;</span> <span class="token keyword">THEN</span>
    <span class="token string">&#39;f&#39;</span>
    <span class="token keyword">ELSE</span> <span class="token string">&#39;m&#39;</span> <span class="token keyword">END</span><span class="token punctuation">;</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="删除重复的电子邮箱-196" tabindex="-1"><a class="header-anchor" href="#删除重复的电子邮箱-196" aria-hidden="true">#</a> 删除重复的电子邮箱（196）</h2><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">DELETE</span>
<span class="token keyword">FROM</span> Person
<span class="token keyword">WHERE</span> id <span class="token operator">NOT</span> <span class="token operator">IN</span> 
    <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token operator">*</span>
    <span class="token keyword">FROM</span> 
        <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token function">min</span><span class="token punctuation">(</span> id <span class="token punctuation">)</span>
        <span class="token keyword">FROM</span> Person
        <span class="token keyword">GROUP</span> <span class="token keyword">BY</span>  email <span class="token punctuation">)</span> t<span class="token punctuation">)</span>
<span class="token comment">-- t是临时表，需要有表名</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- 自己相交，产生笛卡尔积</span>
<span class="token keyword">DELETE</span> p1
<span class="token keyword">FROM</span> Person p1<span class="token punctuation">,</span> Person p2
<span class="token keyword">WHERE</span> p1<span class="token punctuation">.</span>Email <span class="token operator">=</span> p2<span class="token punctuation">.</span>Email
        <span class="token operator">AND</span> p1<span class="token punctuation">.</span>Id <span class="token operator">&gt;</span> p2<span class="token punctuation">.</span>Id 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="修复表中的名字-1667" tabindex="-1"><a class="header-anchor" href="#修复表中的名字-1667" aria-hidden="true">#</a> 修复表中的名字（1667）</h2><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># Write your MySQL query statement below</span>
<span class="token comment"># 一、计算字段</span>

<span class="token comment"># 其实本题主要考察的就是计算字段的使用。</span>
<span class="token comment"># 二、知识点</span>
<span class="token comment"># 2.1 CONCAT() 函数</span>

<span class="token comment"># CONCAT 可以将多个字符串拼接在一起。</span>
<span class="token comment"># 2.2 LEFT(str, length) 函数</span>

<span class="token comment"># 从左开始截取字符串，length 是截取的长度。</span>
<span class="token comment"># 2.3 UPPER(str) 与 LOWER(str)</span>

<span class="token comment"># UPPER(str) 将字符串中所有字符转为大写</span>

<span class="token comment"># LOWER(str) 将字符串中所有字符转为小写</span>
<span class="token comment"># 2.4 SUBSTRING(str, begin, end)</span>

<span class="token comment"># 截取字符串，end 不写默认为空。</span>

<span class="token comment"># SUBSTRING(name, 2) 从第二个截取到末尾，注意并不是下标，就是第二个。</span>

<span class="token comment"># CONCAT 用来拼接字符串 ● LEFT 从左边截取字符 ● RIGHT 从右边截取字符 ● UPPER 变为大写 ● LOWER 变为小写 ● LENGTH 获取字符串长度</span>

<span class="token comment">#1 </span>
<span class="token keyword">SELECT</span> user_id<span class="token punctuation">,</span>
         CONCAT<span class="token punctuation">(</span>UPPER<span class="token punctuation">(</span><span class="token keyword">left</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span>
         <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
         LOWER<span class="token punctuation">(</span>SUBSTRING<span class="token punctuation">(</span>name<span class="token punctuation">,</span>
         <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> name
<span class="token keyword">FROM</span> Users
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span>  user_id
<span class="token comment">#2</span>
<span class="token keyword">SELECT</span> user_id<span class="token punctuation">,</span>
         CONCAT<span class="token punctuation">(</span>UPPER<span class="token punctuation">(</span><span class="token keyword">left</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span>
         <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
         LOWER<span class="token punctuation">(</span><span class="token keyword">RIGHT</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span>
         length<span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> name
<span class="token keyword">FROM</span> Users
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span>  user_id
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="按日期分组销售产品-1484" tabindex="-1"><a class="header-anchor" href="#按日期分组销售产品-1484" aria-hidden="true">#</a> 按日期分组销售产品（1484）</h2><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- group_concat([DISTINCT] 要连接的字段 [Order BY ASC/DESC 排序字段] [Separator &#39;分隔符&#39;])</span>
<span class="token keyword">SELECT</span> sell_date<span class="token punctuation">,</span>
         <span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">distinct</span> product<span class="token punctuation">)</span> num_sold<span class="token punctuation">,</span>
         group_concat<span class="token punctuation">(</span> <span class="token keyword">DISTINCT</span> product
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span>  product separator <span class="token string">&#39;,&#39;</span><span class="token punctuation">)</span> products
<span class="token keyword">FROM</span> Activities
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span>  sell_date
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span>  sell_date
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="患某种疾病的患者-1527" tabindex="-1"><a class="header-anchor" href="#患某种疾病的患者-1527" aria-hidden="true">#</a> 患某种疾病的患者（1527）</h2><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> Patients
<span class="token keyword">WHERE</span> conditions <span class="token operator">LIKE</span> <span class="token string">&#39;DIAB1%&#39;</span>
        <span class="token operator">OR</span> conditions <span class="token operator">LIKE</span> <span class="token string">&#39;% DIAB1%&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> Patients
<span class="token keyword">WHERE</span> conditions <span class="token operator">regexp</span> <span class="token string">&#39;^DIAB1|\\sDIAB1&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="丢失信息的雇员-1965" tabindex="-1"><a class="header-anchor" href="#丢失信息的雇员-1965" aria-hidden="true">#</a> 丢失信息的雇员（1965）</h2><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">#1 两次查询union</span>
<span class="token keyword">SELECT</span> employee_id
<span class="token keyword">FROM</span> Employees
<span class="token keyword">WHERE</span> employee_id <span class="token operator">NOT</span> <span class="token operator">IN</span> 
    <span class="token punctuation">(</span><span class="token keyword">SELECT</span> employee_id
    <span class="token keyword">FROM</span> Salaries<span class="token punctuation">)</span>
<span class="token keyword">UNION</span>
<span class="token keyword">SELECT</span> employee_id
<span class="token keyword">FROM</span> Salaries
<span class="token keyword">WHERE</span> employee_id <span class="token operator">NOT</span> <span class="token operator">IN</span> 
    <span class="token punctuation">(</span><span class="token keyword">SELECT</span> employee_id
    <span class="token keyword">FROM</span> Employees<span class="token punctuation">)</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span>  employee_id 
<span class="token comment">#2 左右连接找null</span>
<span class="token keyword">SELECT</span> e1<span class="token punctuation">.</span>employee_id employee_id
<span class="token keyword">FROM</span> Employees e1
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> Salaries s1
    <span class="token keyword">ON</span> e1<span class="token punctuation">.</span>employee_id <span class="token operator">=</span> s1<span class="token punctuation">.</span>employee_id
<span class="token keyword">WHERE</span> salary <span class="token operator">is</span> <span class="token boolean">null</span>
<span class="token keyword">UNION</span>
<span class="token keyword">SELECT</span> s1<span class="token punctuation">.</span>employee_id employee_id
<span class="token keyword">FROM</span> Employees e1
<span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span> Salaries s1
    <span class="token keyword">ON</span> e1<span class="token punctuation">.</span>employee_id <span class="token operator">=</span> s1<span class="token punctuation">.</span>employee_id
<span class="token keyword">WHERE</span> name <span class="token operator">is</span> <span class="token boolean">null</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span>  employee_id
<span class="token comment">#3 union all 分组统计出现一次的</span>
<span class="token keyword">SELECT</span> employee_id
<span class="token keyword">FROM</span> 
    <span class="token punctuation">(</span><span class="token keyword">SELECT</span> employee_id
    <span class="token keyword">FROM</span> Employees
    <span class="token keyword">UNION</span> <span class="token keyword">ALL</span>
    <span class="token keyword">SELECT</span> employee_id
    <span class="token keyword">FROM</span> Salaries <span class="token punctuation">)</span> <span class="token keyword">AS</span> t
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span>  employee_id
<span class="token keyword">HAVING</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span>  employee_id <span class="token keyword">ASC</span><span class="token punctuation">;</span> 
<span class="token comment">#3 全连接</span>
<span class="token keyword">SELECT</span> e1<span class="token punctuation">.</span>employee_id employee_id
<span class="token keyword">FROM</span> Employees e1
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> Salaries s1
    <span class="token keyword">ON</span> e1<span class="token punctuation">.</span>employee_id <span class="token operator">=</span> s1<span class="token punctuation">.</span>employee_id
<span class="token keyword">WHERE</span> s1<span class="token punctuation">.</span>employee_id <span class="token operator">is</span> <span class="token boolean">null</span>
<span class="token keyword">UNION</span>
<span class="token keyword">SELECT</span> s1<span class="token punctuation">.</span>employee_id employee_id
<span class="token keyword">FROM</span> Employees e1
<span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span> Salaries s1
    <span class="token keyword">ON</span> e1<span class="token punctuation">.</span>employee_id <span class="token operator">=</span> s1<span class="token punctuation">.</span>employee_id
<span class="token keyword">WHERE</span> e1<span class="token punctuation">.</span>employee_id <span class="token operator">is</span> <span class="token boolean">null</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span>  employee_id 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="每个产品在不同商店的价格-1795" tabindex="-1"><a class="header-anchor" href="#每个产品在不同商店的价格-1795" aria-hidden="true">#</a> 每个产品在不同商店的价格（1795）</h2><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">#1 列转行  不加引号是给原有的store1这一列取别名，而值还是原来的值，也就是那些价格数字; 加了引号是说创造一个新的列叫store，这一列的所有值都是&quot;store1&quot;</span>
<span class="token keyword">SELECT</span> product_id<span class="token punctuation">,</span>
        <span class="token string">&#39;store1&#39;</span> store<span class="token punctuation">,</span>store1 price
<span class="token keyword">FROM</span> Products
<span class="token keyword">WHERE</span> store1 <span class="token operator">is</span> <span class="token operator">NOT</span> <span class="token boolean">null</span>
<span class="token keyword">UNION</span>
<span class="token keyword">SELECT</span> product_id<span class="token punctuation">,</span>
        <span class="token string">&#39;store2&#39;</span> store<span class="token punctuation">,</span>store2 price
<span class="token keyword">FROM</span> Products
<span class="token keyword">WHERE</span> store2 <span class="token operator">is</span> <span class="token operator">NOT</span> <span class="token boolean">null</span>
<span class="token keyword">UNION</span>
<span class="token keyword">SELECT</span> product_id<span class="token punctuation">,</span>
        <span class="token string">&#39;store3&#39;</span> store<span class="token punctuation">,</span>store3 price
<span class="token keyword">FROM</span> Products
<span class="token keyword">WHERE</span> store3 <span class="token operator">is</span> <span class="token operator">NOT</span> <span class="token boolean">null</span>
<span class="token comment">#2 行转列这个的意思是如果转回去这么干</span>
<span class="token keyword">SELECT</span> product_id<span class="token punctuation">,</span>
         <span class="token function">SUM</span><span class="token punctuation">(</span><span class="token keyword">IF</span><span class="token punctuation">(</span>store <span class="token operator">=</span> <span class="token string">&#39;store1&#39;</span><span class="token punctuation">,</span> price<span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token string">&#39;store1&#39;</span><span class="token punctuation">,</span> 
         <span class="token function">SUM</span><span class="token punctuation">(</span><span class="token keyword">IF</span><span class="token punctuation">(</span>store <span class="token operator">=</span> <span class="token string">&#39;store2&#39;</span><span class="token punctuation">,</span> price<span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token string">&#39;store2&#39;</span><span class="token punctuation">,</span> 
         <span class="token function">SUM</span><span class="token punctuation">(</span><span class="token keyword">IF</span><span class="token punctuation">(</span>store <span class="token operator">=</span> <span class="token string">&#39;store3&#39;</span><span class="token punctuation">,</span> price<span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token string">&#39;store3&#39;</span>
<span class="token keyword">FROM</span> Products1
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span>  product_id <span class="token punctuation">;</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="树节点-608" tabindex="-1"><a class="header-anchor" href="#树节点-608" aria-hidden="true">#</a> 树节点（608）</h2><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">#1</span>
<span class="token keyword">SELECT</span> id<span class="token punctuation">,</span>
         <span class="token punctuation">(</span>
    <span class="token keyword">CASE</span>
    <span class="token keyword">WHEN</span> p_id <span class="token operator">is</span> <span class="token boolean">NULL</span> <span class="token keyword">THEN</span>
    <span class="token string">&#39;Root&#39;</span>
    <span class="token keyword">WHEN</span> id <span class="token operator">NOT</span> <span class="token operator">IN</span> 
    <span class="token punctuation">(</span><span class="token keyword">SELECT</span> p_id
    <span class="token keyword">FROM</span> tree
    <span class="token keyword">WHERE</span> p_id <span class="token operator">is</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token punctuation">)</span> <span class="token keyword">THEN</span>
        <span class="token string">&#39;Leaf&#39;</span>
        <span class="token keyword">ELSE</span> <span class="token string">&#39;Inner&#39;</span>
        <span class="token keyword">END</span> <span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token keyword">Type</span>
<span class="token keyword">FROM</span> tree
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span>  id
<span class="token comment">#2 </span>
<span class="token keyword">SELECT</span> id<span class="token punctuation">,</span>
<span class="token keyword">case</span>
    <span class="token keyword">WHEN</span> p_id <span class="token operator">is</span> <span class="token boolean">null</span> <span class="token keyword">THEN</span> <span class="token string">&#39;Root&#39;</span>
    <span class="token keyword">WHEN</span> id <span class="token operator">in</span><span class="token punctuation">(</span><span class="token keyword">SELECT</span> p_id <span class="token keyword">From</span> tree<span class="token punctuation">)</span> <span class="token keyword">THEN</span> <span class="token string">&#39;Inner&#39;</span>
    <span class="token keyword">ELSE</span> <span class="token string">&#39;Leaf&#39;</span>
<span class="token keyword">end</span> <span class="token string">&#39;type&#39;</span>
<span class="token keyword">From</span> tree t
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="第二高的薪水-176" tabindex="-1"><a class="header-anchor" href="#第二高的薪水-176" aria-hidden="true">#</a> 第二高的薪水（176）</h2><ol><li><p>当 limit后面跟一个参数的时候，该参数表示要取的数据的数量，例如 select* from user limit 3 表示直接取前三条数据</p></li><li><p>当limit后面跟两个参数的时候，第一个数表示要跳过的数量，后一位表示要取的数量,例如 select * from user limit 1,3; 就是跳过1条数据,从第2条数据开始取，取3条数据，也就是取2,3,4三条数据</p></li><li><p>当 limit和offset组合使用的时候，limit后面只能有一个参数，表示要取的的数量,offset表示要跳过的数量 。例如select * from user limit 3 offset 1;表示跳过1条数据,从第2条数据开始取，取3条数据，也就是取2,3,4三条数据</p></li></ol><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">#1 通过返回临时表 添加NULL</span>
<span class="token keyword">select</span>
    <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> salary
    <span class="token keyword">FROM</span> Employee
    <span class="token keyword">ORDER</span> <span class="token keyword">BY</span>  salary <span class="token keyword">DESC</span> <span class="token keyword">limit</span> <span class="token number">1</span> <span class="token keyword">offset</span> <span class="token number">1</span> <span class="token punctuation">)</span> <span class="token keyword">AS</span> SecondHighestSalary
<span class="token comment">#2 </span>
<span class="token keyword">SELECT</span> IFNULL<span class="token punctuation">(</span> 
    <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> Salary
    <span class="token keyword">FROM</span> Employee
    <span class="token keyword">ORDER</span> <span class="token keyword">BY</span>  Salary <span class="token keyword">DESC</span> <span class="token keyword">LIMIT</span> <span class="token number">1</span> <span class="token keyword">OFFSET</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
         <span class="token boolean">NULL</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> SecondHighestSalary 
<span class="token comment">#3 小于最大的就是第二大的</span>
<span class="token keyword">SELECT</span> <span class="token function">max</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> SecondHighestSalary
<span class="token keyword">FROM</span> Employee
<span class="token keyword">WHERE</span> salary <span class="token operator">&lt;</span>
    <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token function">max</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
    <span class="token keyword">FROM</span> Employee<span class="token punctuation">)</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="组合两个表-175" tabindex="-1"><a class="header-anchor" href="#组合两个表-175" aria-hidden="true">#</a> 组合两个表（175）</h2><p>inner join：2表值都存在</p><p>outer join：附表中值可能存在null的情况。</p><p><strong>总结：</strong></p><p>①A inner join B：取交集</p><p>②A left join B：取A全部，B没有对应的值，则为null</p><p>③A right join B：取B全部，A没有对应的值，则为null</p><p>④A full outer join B：取并集，彼此没有对应的值为null</p><p>上述4种的对应条件，在on后填写。</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> p<span class="token punctuation">.</span>firstName<span class="token punctuation">,</span>
        p<span class="token punctuation">.</span>lastName<span class="token punctuation">,</span>
        a<span class="token punctuation">.</span>city<span class="token punctuation">,</span>
        a<span class="token punctuation">.</span>state
<span class="token keyword">FROM</span> Person p
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> Address a
    <span class="token keyword">ON</span> p<span class="token punctuation">.</span>personId<span class="token operator">=</span>a<span class="token punctuation">.</span>personId 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="进店却未进行过交易的顾客-1581" tabindex="-1"><a class="header-anchor" href="#进店却未进行过交易的顾客-1581" aria-hidden="true">#</a> 进店却未进行过交易的顾客（1581）</h2><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">#1</span>
<span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> customer_id<span class="token punctuation">,</span>
        <span class="token function">count</span><span class="token punctuation">(</span>visit_id<span class="token punctuation">)</span> <span class="token keyword">AS</span> count_no_trans
<span class="token keyword">FROM</span> Visits v
<span class="token keyword">WHERE</span> v<span class="token punctuation">.</span>visit_id <span class="token operator">NOT</span> <span class="token operator">IN</span> 
    <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> visit_id
    <span class="token keyword">FROM</span> <span class="token keyword">Transactions</span><span class="token punctuation">)</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span>  customer_id
<span class="token comment">#2</span>
<span class="token keyword">SELECT</span> customer_id<span class="token punctuation">,</span>
         <span class="token function">count</span><span class="token punctuation">(</span>customer_id<span class="token punctuation">)</span> count_no_trans
<span class="token keyword">FROM</span> Visits
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> <span class="token keyword">Transactions</span>
    <span class="token keyword">ON</span> Visits<span class="token punctuation">.</span>visit_id <span class="token operator">=</span> <span class="token keyword">Transactions</span><span class="token punctuation">.</span>visit_id
<span class="token keyword">WHERE</span> transaction_id <span class="token operator">is</span> <span class="token boolean">null</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span>  customer_id
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="文章浏览-i-1148" tabindex="-1"><a class="header-anchor" href="#文章浏览-i-1148" aria-hidden="true">#</a> 文章浏览 I（1148）</h2><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">#1 </span>
<span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> author_id id
<span class="token keyword">FROM</span> Views
<span class="token keyword">WHERE</span> author_id <span class="token operator">=</span> viewer_id
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span>  author_id
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="上升的温度-197" tabindex="-1"><a class="header-anchor" href="#上升的温度-197" aria-hidden="true">#</a> 上升的温度（197）</h2><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">#1</span>
<span class="token keyword">SELECT</span> b<span class="token punctuation">.</span>id
<span class="token keyword">FROM</span> Weather a
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> Weather b
<span class="token keyword">WHERE</span> DATEDIFF<span class="token punctuation">(</span>b<span class="token punctuation">.</span>recordDate<span class="token punctuation">,</span>a<span class="token punctuation">.</span>recordDate<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span>
        <span class="token operator">AND</span> b<span class="token punctuation">.</span>Temperature <span class="token operator">&gt;</span> a<span class="token punctuation">.</span>Temperature<span class="token punctuation">;</span>
<span class="token comment">#2</span>
<span class="token keyword">SELECT</span> w1<span class="token punctuation">.</span>Id
<span class="token keyword">FROM</span> Weather <span class="token keyword">AS</span> w1<span class="token punctuation">,</span> Weather <span class="token keyword">AS</span> w2
<span class="token keyword">WHERE</span> TIMESTAMPDIFF<span class="token punctuation">(</span><span class="token keyword">DAY</span><span class="token punctuation">,</span> w2<span class="token punctuation">.</span>RecordDate<span class="token punctuation">,</span> w1<span class="token punctuation">.</span>RecordDate<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1</span>
        <span class="token operator">AND</span> w1<span class="token punctuation">.</span>Temperature <span class="token operator">&gt;</span> w2<span class="token punctuation">.</span>Temperature
<span class="token comment">#3</span>
<span class="token keyword">SELECT</span> a<span class="token punctuation">.</span>id
<span class="token keyword">FROM</span> weather a
<span class="token keyword">JOIN</span> weather b
    <span class="token keyword">ON</span> <span class="token punctuation">(</span>a<span class="token punctuation">.</span>recorddate <span class="token operator">=</span> adddate<span class="token punctuation">(</span>b<span class="token punctuation">.</span>recorddate<span class="token punctuation">,</span><span class="token keyword">INTERVAL</span> <span class="token number">1</span> <span class="token keyword">day</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">WHERE</span> a<span class="token punctuation">.</span>temperature <span class="token operator">&gt;</span> b<span class="token punctuation">.</span>temperature
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="销售员-607" tabindex="-1"><a class="header-anchor" href="#销售员-607" aria-hidden="true">#</a> 销售员（607）</h2><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">#1</span>
<span class="token keyword">SELECT</span> s<span class="token punctuation">.</span>name
<span class="token keyword">FROM</span> salesperson s
<span class="token keyword">WHERE</span> s<span class="token punctuation">.</span>sales_id <span class="token operator">NOT</span> <span class="token operator">IN</span> 
    <span class="token punctuation">(</span><span class="token keyword">SELECT</span> o<span class="token punctuation">.</span>sales_id
    <span class="token keyword">FROM</span> orders o
    <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> company c
        <span class="token keyword">ON</span> o<span class="token punctuation">.</span>com_id <span class="token operator">=</span> c<span class="token punctuation">.</span>com_id
    <span class="token keyword">WHERE</span> c<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&#39;RED&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="查询近30天活跃用户数-1141" tabindex="-1"><a class="header-anchor" href="#查询近30天活跃用户数-1141" aria-hidden="true">#</a> 查询近30天活跃用户数（1141）</h2><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> activity_date <span class="token keyword">day</span><span class="token punctuation">,</span>
        <span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">distinct</span> user_id<span class="token punctuation">)</span> active_users
<span class="token keyword">FROM</span> Activity
<span class="token keyword">WHERE</span> datediff<span class="token punctuation">(</span><span class="token string">&#39;2019-07-27&#39;</span><span class="token punctuation">,</span>activity_date<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">30</span>
        <span class="token operator">AND</span> datediff<span class="token punctuation">(</span><span class="token string">&#39;2019-07-27&#39;</span><span class="token punctuation">,</span>activity_date<span class="token punctuation">)</span><span class="token operator">&gt;=</span><span class="token number">0</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span>  activity_date
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="每天的领导和合伙人-1693" tabindex="-1"><a class="header-anchor" href="#每天的领导和合伙人-1693" aria-hidden="true">#</a> 每天的领导和合伙人（1693）</h2><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- group by 可以多字段</span>
<span class="token keyword">SELECT</span> date_id<span class="token punctuation">,</span>
        make_name<span class="token punctuation">,</span>
        <span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">distinct</span> lead_id<span class="token punctuation">)</span> unique_leads <span class="token punctuation">,</span>
         <span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">distinct</span> partner_id<span class="token punctuation">)</span>unique_partners
<span class="token keyword">FROM</span> DailySales
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span>  date_id<span class="token punctuation">,</span>make_name 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="求关注者的数量-1729" tabindex="-1"><a class="header-anchor" href="#求关注者的数量-1729" aria-hidden="true">#</a> 求关注者的数量（1729）</h2><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> user_id<span class="token punctuation">,</span>
         <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> followers_count
<span class="token keyword">FROM</span> Followers
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span>  user_id
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span>  user_id
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="订单最多的客户-586" tabindex="-1"><a class="header-anchor" href="#订单最多的客户-586" aria-hidden="true">#</a> 订单最多的客户（586）</h2><p>SQL <code>ALL</code>运算符必须以比较运算符开头，例如：<code>&gt;</code>，<code>&gt;=</code>，<code>&lt;</code>，<code>&lt;=</code>，<code>&lt;&gt;</code>，<code>=</code>，后跟子查询。 某些数据库系统(如Oracle)允许使用文字值列表而不是子查询。</p><table><thead><tr><th style="text-align:left;">条件</th><th style="text-align:left;">描述</th></tr></thead><tbody><tr><td style="text-align:left;"><code>c &gt; ALL(…)</code></td><td style="text-align:left;"><code>c</code>列中的值必须大于要评估为<code>true</code>的集合中的最大值。</td></tr><tr><td style="text-align:left;"><code>c &gt;= ALL(…)</code></td><td style="text-align:left;"><code>c</code>列中的值必须大于或等于要评估为<code>true</code>的集合中的最大值。</td></tr><tr><td style="text-align:left;"><code>c &lt; ALL(…)</code></td><td style="text-align:left;"><code>c</code>列中的值必须小于要评估为<code>true</code>的集合中的最小值。</td></tr><tr><td style="text-align:left;"><code>c &lt;= ALL(…)</code></td><td style="text-align:left;"><code>c</code>列中的值必须小于或等于要评估为<code>true</code>的集合中的最小值。</td></tr><tr><td style="text-align:left;"><code>c &lt;&gt; ALL(…)</code></td><td style="text-align:left;"><code>c</code>列中的值不得等于要评估为<code>true</code>的集合中的任何值。</td></tr><tr><td style="text-align:left;"><code>c = ALL(…)</code></td><td style="text-align:left;"><code>c</code>列中的值必须等于要评估为<code>true</code>的集合中的任何值。</td></tr></tbody></table><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">#1</span>
<span class="token keyword">SELECT</span> customer_number
<span class="token keyword">FROM</span> 
    <span class="token punctuation">(</span><span class="token keyword">SELECT</span> customer_number<span class="token punctuation">,</span>
        <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> customer_count
    <span class="token keyword">FROM</span> Orders
    <span class="token keyword">GROUP</span> <span class="token keyword">BY</span>  customer_number <span class="token punctuation">)</span> <span class="token keyword">AS</span> t
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span>  t<span class="token punctuation">.</span>customer_count <span class="token keyword">DESC</span> <span class="token keyword">limit</span> <span class="token number">1</span> 
<span class="token comment">#2</span>
<span class="token keyword">SELECT</span> customer_number
<span class="token keyword">FROM</span> Orders
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span>  customer_number
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span>  <span class="token function">count</span><span class="token punctuation">(</span>customer_number<span class="token punctuation">)</span> <span class="token keyword">DESC</span> <span class="token keyword">limit</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token comment">#3</span>
<span class="token comment">/*HAVING 子句
在 SQL 中增加 HAVING 子句原因是，WHERE 关键字无法与合计函数一起使用。
SQL HAVING 语法:
SELECT column_name, aggregate_function(column_name)
FROM table_name
WHERE column_name operator value
GROUP BY column_name
HAVING aggregate_function(column_name) operator value
*/</span>
<span class="token keyword">SELECT</span> customer_number
<span class="token keyword">FROM</span> Orders
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span>  customer_number
<span class="token keyword">HAVING</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&gt;=</span> <span class="token keyword">all</span>
    <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
    <span class="token keyword">FROM</span> Orders
    <span class="token keyword">GROUP</span> <span class="token keyword">BY</span>  customer_number <span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="游戏玩法分析-i-511" tabindex="-1"><a class="header-anchor" href="#游戏玩法分析-i-511" aria-hidden="true">#</a> 游戏玩法分析 I（511）</h2><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> player_id<span class="token punctuation">,</span>
        <span class="token function">min</span><span class="token punctuation">(</span>event_date<span class="token punctuation">)</span> first_login
<span class="token keyword">FROM</span> Activity
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span>  player_id
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2020年最后一次登录-1890" tabindex="-1"><a class="header-anchor" href="#_2020年最后一次登录-1890" aria-hidden="true">#</a> 2020年最后一次登录（1890）</h2><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">#1</span>
<span class="token keyword">SELECT</span> user_id <span class="token punctuation">,</span>
        <span class="token function">max</span><span class="token punctuation">(</span>time_stamp<span class="token punctuation">)</span> last_stamp
<span class="token keyword">FROM</span> Logins
<span class="token keyword">WHERE</span> <span class="token keyword">YEar</span><span class="token punctuation">(</span>time_stamp<span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">&#39;2020&#39;</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span>  user_id
<span class="token comment">#2</span>
<span class="token keyword">SELECT</span> user_id <span class="token punctuation">,</span>
        <span class="token function">max</span><span class="token punctuation">(</span>time_stamp<span class="token punctuation">)</span> last_stamp
<span class="token keyword">FROM</span> Logins
<span class="token keyword">WHERE</span> timediff<span class="token punctuation">(</span>time_stamp<span class="token punctuation">,</span><span class="token string">&#39;2020-01-01 00:00:00&#39;</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">0</span>
        <span class="token operator">AND</span> timediff<span class="token punctuation">(</span>time_stamp<span class="token punctuation">,</span><span class="token string">&#39;2020-12-31 23:59:59&#39;</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">0</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span>  user_id 
<span class="token comment">#3</span>
<span class="token keyword">SELECT</span> user_id <span class="token punctuation">,</span>
        <span class="token function">max</span><span class="token punctuation">(</span>time_stamp<span class="token punctuation">)</span> last_stamp
<span class="token keyword">FROM</span> Logins
<span class="token keyword">WHERE</span> datediff<span class="token punctuation">(</span>time_stamp<span class="token punctuation">,</span><span class="token string">&#39;2020-01-01 00:00:00&#39;</span><span class="token punctuation">)</span><span class="token operator">&gt;=</span><span class="token number">0</span>
        <span class="token operator">AND</span> datediff<span class="token punctuation">(</span>time_stamp<span class="token punctuation">,</span><span class="token string">&#39;2020-12-31 23:59:59&#39;</span><span class="token punctuation">)</span><span class="token operator">&lt;=</span><span class="token number">0</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span>  user_id
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="查找每个员工花费的总时间-1741" tabindex="-1"><a class="header-anchor" href="#查找每个员工花费的总时间-1741" aria-hidden="true">#</a> 查找每个员工花费的总时间（1741）</h2><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> event_day <span class="token keyword">day</span><span class="token punctuation">,</span>
        emp_id<span class="token punctuation">,</span>
        <span class="token function">sum</span><span class="token punctuation">(</span>out_time<span class="token operator">-</span>in_time<span class="token punctuation">)</span> total_time
<span class="token keyword">FROM</span> Employees
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span>  emp_id <span class="token punctuation">,</span>event_day
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><!--[--><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">上次更新: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">作者: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: 1814300923@qq.com">Chenxuwkk</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/blog/study/page24.html" class="" aria-label="动态规划专项"><!--[--><!--]--> 动态规划专项 <!--[--><!--]--></a></span><!----></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/blog/assets/app.b33ca31f.js" defer></script>
  </body>
</html>
